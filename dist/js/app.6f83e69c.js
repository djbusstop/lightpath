(function(t){function e(e){for(var a,s,i=e[0],c=e[1],d=e[2],u=0,p=[];u<i.length;u++)s=i[u],Object.prototype.hasOwnProperty.call(r,s)&&r[s]&&p.push(r[s][0]),r[s]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(t[a]=c[a]);l&&l(e);while(p.length)p.shift()();return n.push.apply(n,d||[]),o()}function o(){for(var t,e=0;e<n.length;e++){for(var o=n[e],a=!0,i=1;i<o.length;i++){var c=o[i];0!==r[c]&&(a=!1)}a&&(n.splice(e--,1),t=s(s.s=o[0]))}return t}var a={},r={app:0},n=[];function s(e){if(a[e])return a[e].exports;var o=a[e]={i:e,l:!1,exports:{}};return t[e].call(o.exports,o,o.exports,s),o.l=!0,o.exports}s.m=t,s.c=a,s.d=function(t,e,o){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(s.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)s.d(o,a,function(e){return t[e]}.bind(null,a));return o},s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],c=i.push.bind(i);i.push=e,i=i.slice();for(var d=0;d<i.length;d++)e(i[d]);var l=c;n.push([0,"chunk-vendors"]),o()})({0:function(t,e,o){t.exports=o("56d7")},"56d7":function(t,e,o){"use strict";o.r(e);var a=o("2b0e"),r=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("v-app",[o("v-app-bar",{attrs:{elevation:"2",color:"primary",app:"",dense:"","hide-on-scroll":""}},[o("v-spacer"),o("v-toolbar-title",{staticClass:"headline text-uppercase"},[o("span",{staticClass:"white--text font-weight-bold"},[t._v("LightPath")])]),o("v-spacer")],1),o("v-content",[o("home-page")],1)],1)},n=[],s=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("v-container",[t.messages.length>0?o("div",t._l(t.messages,(function(e){return o("v-alert",{key:e.key,attrs:{type:e.type,dismissible:!0},model:{value:e.display,callback:function(o){t.$set(e,"display",o)},expression:"message.display"}},[t._v("\n        "+t._s(e.content)+"\n      ")])})),1):t._e(),o("input-fields",{attrs:{"user-coords":t.userCoords},on:{"submit-form":t.getData,message:t.makeMessage}}),o("map-view",{attrs:{"user-coords":t.userCoords,data:t.data},on:{message:t.makeMessage}})],1)},i=[],c=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("v-card",[o("v-container",[o("v-row",{attrs:{"no-gutters":""}},[o("v-flex",{attrs:{"sm-12":""}},[o("v-text-field",{attrs:{outlined:"",label:"Start"},model:{value:t.fromLocation,callback:function(e){t.fromLocation=e},expression:"fromLocation"}})],1)],1),o("v-row",{attrs:{"no-gutters":""}},[o("v-flex",{attrs:{"sm-12":""}},[o("v-text-field",{attrs:{outlined:"",label:"End"},model:{value:t.toLocation,callback:function(e){t.toLocation=e},expression:"toLocation"}})],1)],1),o("v-row",{attrs:{"no-gutters":""}},[o("v-spacer"),o("v-btn",{attrs:{color:"primary"},on:{click:function(e){return t.submit()}}},[t._v("Go")])],1)],1)],1)},d=[];const l="15f9a2399c8c4abea6c2251bcbbb4755";var u={name:"input-fields",data(){return{fromLocation:null,toLocation:null,fromCoords:null,toCoords:null}},props:{userCoords:{type:void 0}},watch:{async userCoords(t){t&&(this.fromCoords=t,this.fromLocation=await this.getAddressfromCoords(t))}},methods:{async getAddressfromCoords(t){const e=`https://api.opencagedata.com/geocode/v1/geojson?q=${t[0]}+${t[1]}&key=${l}`;try{const t=await fetch(e),o=await t.json();return o.features[0].properties.formatted}catch{this.$emit("message",{type:"error",content:"Could not find address from coordinates"})}},async getCoordsFromAddress(t){try{const e=`https://api.opencagedata.com/geocode/v1/geojson?q=${t}&key=${l}`,o=await fetch(e),a=await o.json(),r=a.features[0].geometry.coordinates;return r.reverse()}catch{this.$emit("message",{type:"error",content:"Could not find location for address"})}},async submit(){this.toLocation&&this.fromLocation?(this.fromCoords||(this.fromCoords=await this.getCoordsFromAddress(this.fromLocation)),this.toCoords=await this.getCoordsFromAddress(this.toLocation),this.$emit("submit-form",{fromLocation:this.fromCoords.reverse(),toLocation:this.toCoords.reverse()})):this.$emit("message",{type:"error",content:"Fields incomplete"})}}},p=u,m=o("2877"),f=o("6544"),h=o.n(f),g=o("8336"),v=o("b0af"),y=o("a523"),b=o("0e8f"),w=o("0fd9"),C=o("2fa4"),P=o("8654"),x=Object(m["a"])(p,c,d,!1,null,null,null),O=x.exports;h()(x,{VBtn:g["a"],VCard:v["a"],VContainer:y["a"],VFlex:b["a"],VRow:w["a"],VSpacer:C["a"],VTextField:P["a"]});var j=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("v-card",{staticClass:"mt-4",attrs:{id:"map-card"}},[o("div",{attrs:{id:"map"}})])},_=[],S=o("e11e"),V=o.n(S);const k={color:"#F9971E",weight:5},L={color:"#F9971E",radius:10,fillOpacity:1};class $ extends V.a.Map{constructor(t,e){super(t,e);const o="http://tile.stamen.com/terrain/{Z}/{X}/{Y}.png",a=o.replace(/({[A-Z]})/g,t=>t.toLowerCase()),r=V.a.tileLayer(a,{subdomains:["","a.","b.","c.","d."],minZoom:0,maxZoom:17,type:"png",attribution:'Map tiles by <a href="http://stamen.com">Stamen Design</a>, under <a href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a>. Data by <a href="http://openstreetmap.org">OpenStreetMap</a>, under <a href="http://creativecommons.org/licenses/by-sa/3.0">CC BY SA</a>'});r.addTo(this),this.setView([51.505,-.09],13)}drawRoute(t){V.a.geoJSON(t.geojson,k).addTo(this),this.drawStartEndPoints([t.startPoint,t.endPoint])}drawStartEndPoints(t){t.forEach(t=>{const e=V.a.circle(t.reverse(),L);e.addTo(this)})}fitZoomToRoute(t){this.fitBounds(t)}}var E={name:"map-view",props:{data:{type:void 0},userCoords:{type:void 0}},data(){return{map:null}},mounted(){this.initMap()},watch:{userCoords(t){t&&this.map.setView(t,14)},data(t){if(t){this.map.drawRoute(t),this.map.fitZoomToRoute([t.startPoint,t.endPoint]);const e=document.getElementById("map");e&&e.scrollIntoView()}}},methods:{initMap(){this.$nextTick(()=>{this.map=new $("map",{zoomControl:!1})})}}},M=E,T=(o("8ff2a"),Object(m["a"])(M,j,_,!1,null,null,null)),A=T.exports;h()(T,{VCard:v["a"]});class F{constructor(t){if(1===t.features[0].geometry.coordinates.length)throw new Error("No line, only point");this.geojson=t,this.startPoint=F.getStartPoint(t),this.endPoint=F.getEndPoint(t)}static getStartPoint(t){return t.features[0].geometry.coordinates[0]}static getEndPoint(t){const{features:e}=t,o=e[e.length-1],{coordinates:a}=o.geometry;return a[a.length-1]}}const B="http://wetravel-be.herokuapp.com",Z=`${B}/findpath`;class J{static async findPath(t){console.log(JSON.stringify(t));const e=await fetch(Z,{method:"POST",body:JSON.stringify(t)}),o=await e.json();return o}}var R={name:"home-page",components:{InputFields:O,MapView:A},data:()=>({data:void 0,distance:null,userCoords:null,messages:[]}),mounted(){this.getUserCoords()},methods:{async getData(t){try{const e=await J.findPath(t);this.distance=e.distance,this.data=new F(e.data)}catch{this.makeMessage({type:"error",content:"Could not find route"})}},async getUserCoords(){navigator.geolocation.getCurrentPosition(async t=>{const e=[t.coords.latitude,t.coords.longitude];this.userCoords=e})},makeMessage(t){this.messages.push({key:this.messages.length,display:!0,type:t.type,content:t.content})}}},D=R,N=o("0798"),I=Object(m["a"])(D,s,i,!1,null,null,null),Y=I.exports;h()(I,{VAlert:N["a"],VContainer:y["a"]});var q={name:"App",components:{HomePage:Y},data:()=>({})},U=q,z=o("7496"),G=o("40dc"),H=o("a75b"),X=o("2a7f"),K=Object(m["a"])(U,r,n,!1,null,null,null),Q=K.exports;h()(K,{VApp:z["a"],VAppBar:G["a"],VContent:H["a"],VSpacer:C["a"],VToolbarTitle:X["a"]});o("5363");var W=o("f309");a["a"].use(W["a"]);var tt=new W["a"]({icons:{iconfont:"mdi"},theme:{themes:{light:{primary:"#00A991",secondary:"#005C4E",accent:"#8c9eff",error:"#b71c1c"}}}});a["a"].config.productionTip=!1,new a["a"]({vuetify:tt,render:t=>t(Q)}).$mount("#app")},"8ff2a":function(t,e,o){"use strict";var a=o("b681"),r=o.n(a);r.a},b681:function(t,e,o){}});
//# sourceMappingURL=app.6f83e69c.js.map